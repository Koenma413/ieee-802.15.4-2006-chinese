# 7.5.1.1 超帧结构

　　在 PAN 网络中，协调器可以使用超帧结构来限定设备对信道的访问时间。通过发送信标帧就能实现超帧限定。超帧分为两个时间段：活跃期和非活跃期。在非活跃期内，协调器进入低功耗模式（即睡眠模式）。

　　变量 *macBeaconOrder(BO)* 和 *macSuperframeOrder(SO)* 用于描述一个超帧结构。BO 决定了协调器传输信标帧的时间间隔 BI，SO 决定了活跃期（包括信标在内）的时间长度 SD，其关系如下：

$$
BI = aBaseSuperframeDuration * 2^{BO}
$$$$
SD = aBaseSuperframeDuration * 2^{SO}
$$　　其中：0 ≤ SO ≤ BO ≤ 14

　　当 BO = 15，协调器不传输信标帧（除非被要求传输信标帧，比如接收到一个信标请求命令）。当 BO = 15 时，macSuperframeOrder 的值将被忽略。
  
## 7.5.1.1.1. 竞争接入阶段CAP

　　在一个超帧内，信标帧之后紧接着就是竞争接入阶段 CAP，且 CAP 必须在免竞争阶段 CFP 之前完成。如果 CFP 的长度是0，那么 CAP 就必须在超帧的有效期结束之前完成。在一般情况下，CAP 应当大于 aMinCAPLength，但是有时为了维护 GTS，需要增加信标帧的长度，因此临时需要额外的空间，导致 CAP 小于 aMinCAPLength。为了自适应 CFP 的尺寸，也需要动态地缩减或增加空间。

　　所有的帧，除确认帧和紧跟随确认帧之后的数据帧之外，在 CAP 阶段都需要使用 CSMA/CA 机制访问信道。如果设备想在一个 CAP 阶段内传输，它必须保证其传输过程在该超帧的 CFP 之前完成，否则需要等到下一个超帧的 CAP 阶段才能开始传输。

　　MAC 命令帧总是在 CAP 阶段被传输。
### 7.5.1.1.2 免竞争阶段CFP(Contention-free period)

　　免竞争阶段 CFP 应该紧紧跟在竞争接入阶段 CAP 后面，且必须在超帧的有效期内完成。如果 PAN 协调器分配了 GTS，则这些 GTS 应该处于 CFP 内，且占据连续的时序。CFP 根据所绑定的 GTS 总长度进行增长或缩减。
　　
　　CFP 内的传输访问信道时不需要使用 CSMA/AC 机制。设备在 CFP 内传输数据时，必须保证在一个帧间间隔内完成，且必须在 GTS 结束之前完成。
